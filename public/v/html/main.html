<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keywords" content="" />
    <title></title>

    <!-- ========== Css Files ========== -->
    <link href="../css/root.css" rel="stylesheet">

    <style>
        body {
            background-color: #edf0f5;
        }
    </style>
</head>
<body style="background-color:#edf0f5;font-size:15px !important">
    <!-- Start Page Loading -->
    <div class="loading"><img src="../img/loading.gif" alt="loading-img"></div>
    <!-- End Page Loading -->
    <!-- //////////////////////////////////////////////////////////////////////////// -->
    <!-- START TOP -->
    <div id="top" class="clearfix">

        <!-- Start App Logo -->
        <div class="applogo">
            <a href="#" class="logo">菜 单</a>
        </div>
        <!-- End App Logo -->
        <!-- Start Sidebar Show Hide Button -->
        <a href="#" class="sidebar-open-button"><i class="fa fa-bars"></i></a>
        <a href="#" class="sidebar-open-button-mobile"><i class="fa fa-bars"></i></a>
        <!-- End Sidebar Show Hide Button -->
        <!-- page title -->
        <h1 class="title">自助售药机后台管理系统</h1>
        <!-- End page title -->

    </div>
    <!-- END TOP -->
    <!-- //////////////////////////////////////////////////////////////////////////// -->
    <!-- //////////////////////////////////////////////////////////////////////////// -->
    <!-- START SIDEBAR -->
    <div class="sidebar clearfix">
        <div class="dropdown link">
            <a href="#" data-toggle="dropdown" class="dropdown-toggle profilebox">
                <img src="../img/profileimg.png" alt="img">
                <div class="user-name" id="showUser"><b>范 枭(askdixuoiwerwerweqr)</b><span class="caret"></span></div>
            </a>
            <ul class="dropdown-menu dropdown-menu-list dropdown-menu-right">
                <li role="presentation" class="dropdown-header">选项</li>

                <li><a href="login.html"><i class="fa falist fa-power-off"></i> 退出</a></li>
            </ul>
        </div>

        <ul class="sidebar-panel nav">
            <li class="sidetitle">机器管理</li>
            <li><a href="main.html"><span class="icon color5"><i class="fa fa-home"></i></span>运行状态</a></li>
            <li>
                <a href="#"><span class="icon color7"><i class="fa fa-laptop"></i></span>药机管理<span class="caret"></span></a>
                <ul>
                    <li><a href="machineGroup.html">机器分组</a></li>
                    <li><a href="motor.html">货道设置</a></li>
                    <li><a href="">机器信息设置</a></li>
                </ul>
            </li>
            <li><a href=""><span class="icon color6"><i class="fa fa-bar-chart"></i></span>温湿度详情</a></li>
        </ul>
        <ul class="sidebar-panel nav">
            <li class="sidetitle">药品管理</li>
            <li><a href="blank1.html"><span class="icon color5"><i class="fa fa-folder"></i></span>分类管理</a></li>
            <li><a href="#"><span class="icon color6"><i class="fa fa-calendar"></i></span>药品列表</a></li>
            <li><a href="#"><span class="icon color7"><i class="fa fa-sort-amount-asc"></i></span>期效管理<span class="caret"></span></a></li>
            <li><a href="#"><span class="icon color6"><i class="fa fa-file-word-o"></i></span>批号管理</a></li>
        </ul>
        <ul class="sidebar-panel nav">
            <li class="sidetitle">记录管理</li>
            <li><a href="blank1.html"><span class="icon color5"><i class="fa fa-calendar-o"></i></span>销售记录</a></li>
            <li><a href=""><span class="icon color6"><i class="fa fa-calendar"></i></span>操作记录</a></li>
            <li>
                <a href="#"><span class="icon color7"><i class="fa fa-calendar-o"></i></span>药品记录<span class="caret"></span></a>
                <ul>
                    <li><a href="">上药记录</a></li>
                    <li><a href="">撤药记录</a></li>
                </ul>
            </li>
            <li><a href=""><span class="icon color6"><i class="fa fa-calendar"></i></span>报警记录</a></li>
        </ul>
        <ul class="sidebar-panel nav">
            <li class="sidetitle">用户管理</li>
            <li><a href="blank1.html"><span class="icon color5"><i class="fa fa-user"></i></span>用户信息</a></li>
        </ul>

        <ul class="sidebar-panel nav">
            <li class="sidetitle">财务管理</li>
            <li><a href="blank1.html"><span class="icon color5"><i class="fa fa-calendar-o"></i></span>销售统计</a></li>
        </ul>

        <ul class="sidebar-panel nav">
            <li class="sidetitle">其他设置</li>
            <li><a href="typography.html"><span class="icon color12"><i class="fa fa-cog"></i></span>系统设置</a></li>
        </ul>



    </div>
    <!-- END SIDEBAR -->
    <!-- //////////////////////////////////////////////////////////////////////////// -->
    <!-- //////////////////////////////////////////////////////////////////////////// -->
    <!-- START CONTENT -->
    <div class="content">

        <!-- Start Page breadcrumb -->
        <div class="page-header">

            <ol class="breadcrumb">
                <li>机器管理</li>
                <li>运行状态</li>
            </ol>



        </div>
        <!-- End Page breadcrumb -->
        <!-- //////////////////////////////////////////////////////////////////////////// -->
        <!-- START CONTAINER -->
        <div class="container-padding container-widget">


            <!-- Start Row -->
            <div class="row">

                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <form class="form-inline">
                                <div class="form-group">
                                    <label for="machineName" class="form-label">机器名称：</label>
                                    <input type="text" class="form-control form-control-radius" id="machineName" value="">
                                </div>
                                <div class="form-group">
                                    <label for="machineID" class="form-label">机器ID：</label>
                                    <input type="text" class="form-control form-control-radius" id="machineID" value="">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">机器分组：</label>
                                    <select class="selectpicker" id="machineGroup">
                                        <option>全部</option>
                                    </select>
                                </div>
                                <button type="button" class="btn btn-default" onclick="addTableItem($('#machineGroup').val(),$('#machineName').val()+'',$('#machineID').val()+'')">查询</button>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Start Panel -->
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-title" style="display:none">
                            运行状态
                        </div>

                        <div class="panel-body table-responsive" id="tableParent">

                            <table id="table" class="table "></table>


                        </div>

                    </div>
                </div>
                <!-- End Panel -->


            </div>
            <!-- End Row -->


        </div>
        <!-- END CONTAINER -->
        <!-- //////////////////////////////////////////////////////////////////////////// -->





    </div>
    <!-- End Content -->
    <!-- //////////////////////////////////////////////////////////////////////////// -->
    <!-- Start Footer -->
    <div class="row footer" style="display:none">
        <div class="col-md-6 text-left">
            Copyright &copy; 2018.Company name All rights reserved.<a href="#">沈阳华天基曼龙有限公司</a>
        </div>
        <div class="col-md-6 text-right">

        </div>
    </div>
    <!-- End Footer -->
    <!-- ================================================
    jQuery Library
    ================================================ -->
    <script type="text/javascript" src="../js/jquery.min.js"></script>

    <!-- ================================================
    Bootstrap Core JavaScript File
    ================================================ -->
    <script src="../js/bootstrap/bootstrap.min.js"></script>

    <!-- ================================================
    Plugin.js - Some Specific JS codes for Plugin Settings
    ================================================ -->
    <script type="text/javascript" src="../js/plugins.js"></script>

    <!-- ================================================
    Data Tables
    ================================================ -->
    <script src="../js/datatables/datatables.min.js"></script>

    <!-- ================================================
    Bootstrap Select
    ================================================ -->
    <script type="text/javascript" src="../js/bootstrap-select/bootstrap-select.js"></script>

    <!-- ================================================
    Bootstrap Toggle
    ================================================ -->
    <script type="text/javascript" src="../js/bootstrap-toggle/bootstrap-toggle.min.js"></script>

    <!-- ================================================
    Moment.js
    ================================================ -->
    <script type="text/javascript" src="../js/moment/moment.min.js"></script>

    <!-- ================================================
    Bootstrap Date Range Picker
    ================================================ -->
    <script type="text/javascript" src="../js/date-range-picker/daterangepicker.js"></script>

    <script>

        // 设置显示的用户名
        $("#showUser").html(user.realname + "(" + user.username + ")");

        // 查询机器分组
        var groups = commonBind.MachineGroupJsonStr();
        var groupObj = JSON.parse(groups);
        $("#machineGroup").empty();
        var optionStr = "<option value='0'>全部</option>";
        for (var gItem in groupObj) {
            optionStr += "<option value='" + groupObj[gItem].id + "'>" + groupObj[gItem].machine_group_name + "</option>"
        }
        $("#machineGroup").append(optionStr);

        // 添加表格项
        function addTableItem(machineGroupId, machineName, machineId) {
            var patt = new RegExp(/[!@#\$%\^&\*\(\)\|\?\\\[\]\{=]/);
            if (patt.test(machineName)) {
                alert("不可以输入特殊字符");
                return;
            }
            if (patt.test(machineId)) {
                alert("不可以输入特殊字符");
                return;
            }

            $("#tableParent").empty();
            $("#tableParent").append("<table id='table' class='table'><thead><tr><th>机器IDd</th><th>机器名称</th><th>机器位置</th><th>机柜一温湿度</th><th>机柜二温湿度</th><th>更新时间</th><th>是否在线</th><th>管理人员</th><th>驻店药师</th><th>货道状态</th></tr></thead></table>");

            var jsonStr = commonBind.MotorRunInfo(machineGroupId, machineName.trim(), machineId.trim());
            var jsonObj = JSON.parse(jsonStr);

            var dataSet = [];
            for (var item in jsonObj) {
                dataSet.push(new Array(jsonObj[item].machine_id, jsonObj[item].machine_name, jsonObj[item].location, jsonObj[item].cabinet1, jsonObj[item].cabinet2, jsonObj[item].update_time, jsonObj[item].is_online, jsonObj[item].pyname, jsonObj[item].sename, jsonObj[item].fault))
            }

            //$('#table').DataTable({
            //    "data": dataSet,
            //    "columns": [
            //        { "title": "机器ID" },
            //        { "title": "机器名称" },
            //        { "title": "机器位置" },
            //        { "title": "机柜一温湿度" },
            //        { "title": "机柜二温湿度" },
            //        { "title": "更新时间" },
            //        { "title": "是否在线" },
            //        { "title": "管理人员" },
            //        { "title": "驻店药师" },
            //        { "title": "货道状态" }
            //    ],
            //    "pagingType": "full_numbers",
            //    "createdRow": function (row, data, index) {
            //        if (parseInt(data[9]) == 1) {
            //            $('td', row).eq(9).html("故障");
            //            $('td', row).eq(9).addClass('danger');
            //        } else {
            //            $('td', row).eq(9).html("正常");
            //            $('td', row).eq(9).addClass('success');
            //        }

            //        if (parseInt(data[6]) == 1) {
            //            $('td', row).eq(6).html("在线");
            //            $('td', row).eq(6).addClass('success');
            //        } else {
            //            $('td', row).eq(6).html("离线");
            //            $('td', row).eq(6).addClass('danger');
            //        }

            //        var sp3 = data[3].split(',');
            //        $('td', row).eq(3).html(sp3[0]);
            //        if (parseInt(sp3[1]) == 1) {
            //            $('td', row).eq(3).addClass('danger');
            //        } else {
            //            $('td', row).eq(3).addClass('success');
            //        }

            //        var sp4 = data[4].split(',');
            //        $('td', row).eq(4).html(sp4[0]);
            //        if (parseInt(sp4[1]) == 1) {
            //            $('td', row).eq(4).addClass('danger');
            //        } else {
            //            $('td', row).eq(4).addClass('success');
            //        }
            //    },
            //    "iDisplayLength": 50,
            //    "bFilter": false,
            //    "bLengthChange": false,
            //    "bInfo": false
            //});

            $('#table').dataTable(
                {
                    "serverSide": true,
                    "ajax": {
                        cache: false,
                        type: "POST",
                        url: "http://127.0.0.1:8081/fuck",
                        dataType: "JSON",
                        processData:true ,
                        contentType: "text/html",
                        error: function () {
                            alert("草泥马");
                        }
                    }
                }

             );
        }


        addTableItem('0', '', '');



    </script>




</body>
</html>