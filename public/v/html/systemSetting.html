<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keywords" content="" />
    <title></title>

    <!-- ========== Css Files ========== -->
    <link href="../css/root.css" rel="stylesheet">

</head>
<body style="background-color:#edf0f5;font-size:15px !important">
    <!-- Start Page Loading -->
    <div class="loading"><img src="../img/loading.gif" alt="loading-img"></div>
    <!-- End Page Loading -->
    <!-- //////////////////////////////////////////////////////////////////////////// -->
    <!-- START TOP -->
    <div id="top" class="clearfix">

        <!-- Start App Logo -->
        <div class="applogo">
            <a href="#" class="logo">菜 单</a>
        </div>
        <!-- End App Logo -->
        <!-- Start Sidebar Show Hide Button -->
        <a href="#" class="sidebar-open-button"><i class="fa fa-bars"></i></a>
        <a href="#" class="sidebar-open-button-mobile"><i class="fa fa-bars"></i></a>
        <!-- End Sidebar Show Hide Button -->
        <!-- page title -->
        <h1 class="title">自助售药机后台管理系统</h1>
        <!-- End page title -->

    </div>
    <!-- END TOP -->
    <!-- //////////////////////////////////////////////////////////////////////////// -->
    <!-- //////////////////////////////////////////////////////////////////////////// -->
    <!-- START SIDEBAR -->
    <div class="sidebar clearfix">
        <div class="dropdown link">
            <a href="#" data-toggle="dropdown" class="dropdown-toggle profilebox">
                <img src="../img/profileimg.png" alt="img">
                <div class="user-name" id="showUser"><b>范 枭(askdixuoiwerwerweqr)</b><span class="caret"></span></div>
            </a>
            <ul class="dropdown-menu dropdown-menu-list dropdown-menu-right">
                <li role="presentation" class="dropdown-header">选项</li>

                <li><a href="login.html"><i class="fa falist fa-power-off"></i> 退出</a></li>
            </ul>
        </div>

        <ul class="sidebar-panel nav">
            <li class="sidetitle">机器管理</li>
            <li><a href="main.html"><span class="icon color5"><i class="fa fa-home"></i></span>运行状态</a></li>
            <li>
                <a href="#"><span class="icon color7"><i class="fa fa-laptop"></i></span>药机管理<span class="caret"></span></a>
                <ul>
                    <li><a href="machineGroup.html">机器分组</a></li>
                    <li><a href="motor.html">货道设置</a></li>
                    <li><a href="">机器信息设置</a></li>
                </ul>
            </li>
            <li><a href=""><span class="icon color6"><i class="fa fa-bar-chart"></i></span>温湿度详情</a></li>
        </ul>
        <ul class="sidebar-panel nav">
            <li class="sidetitle">药品管理</li>
            <li><a href="blank1.html"><span class="icon color5"><i class="fa fa-folder"></i></span>分类管理</a></li>
            <li><a href="#"><span class="icon color6"><i class="fa fa-calendar"></i></span>药品列表</a></li>
            <li><a href="#"><span class="icon color7"><i class="fa fa-sort-amount-asc"></i></span>期效管理<span class="caret"></span></a></li>
            <li><a href="#"><span class="icon color6"><i class="fa fa-file-word-o"></i></span>批号管理</a></li>
        </ul>
        <ul class="sidebar-panel nav">
            <li class="sidetitle">记录管理</li>
            <li><a href="blank1.html"><span class="icon color5"><i class="fa fa-calendar-o"></i></span>销售记录</a></li>
            <li><a href=""><span class="icon color6"><i class="fa fa-calendar"></i></span>操作记录</a></li>
            <li>
                <a href="#"><span class="icon color7"><i class="fa fa-calendar-o"></i></span>药品记录<span class="caret"></span></a>
                <ul>
                    <li><a href="">上药记录</a></li>
                    <li><a href="">撤药记录</a></li>
                </ul>
            </li>
            <li><a href=""><span class="icon color6"><i class="fa fa-calendar"></i></span>报警记录</a></li>
        </ul>
        <ul class="sidebar-panel nav">
            <li class="sidetitle">用户管理</li>
            <li><a href="blank1.html"><span class="icon color5"><i class="fa fa-user"></i></span>用户信息</a></li>
        </ul>

        <ul class="sidebar-panel nav">
            <li class="sidetitle">财务管理</li>
            <li><a href="blank1.html"><span class="icon color5"><i class="fa fa-calendar-o"></i></span>销售统计</a></li>
        </ul>

        <ul class="sidebar-panel nav">
            <li class="sidetitle">其他设置</li>
            <li><a href="typography.html"><span class="icon color12"><i class="fa fa-cog"></i></span>系统设置</a></li>
        </ul>



    </div>
    <!-- END SIDEBAR -->
    <!-- //////////////////////////////////////////////////////////////////////////// -->
    <!-- START CONTENT -->
    <div class="content">

        <!-- Start Page breadcrumb -->
        <div class="page-header">
            <ol class="breadcrumb">
                <li>其他设置</li>
                <li>系统设置</li>
            </ol>
        </div>
        <!-- End Page breadcrumb -->
        <!-- //////////////////////////////////////////////////////////////////////////// -->
        <!-- START CONTAINER -->
        <div class="container-padding container-widget">

            <div class="row">
                <!-- 支付参数设置 -->
                <div class="col-md-12 col-lg-6">
                    <div class="panel panel-widget">
                        <div class="panel-title " style="font-size:15px">
                            支付参数
                        </div>
                        <div class="panel-body ">
                            <label for="zfbappid" class="form-label">支付宝appid：</label>
                            <input type="text" class="form-control form-control-radius" id="zfbappid" value="" spellcheck="false">
                            <br>
                            <label for="wxappid" class="form-label">微信appid：</label>
                            <input type="text" class="form-control form-control-radius" id="wxappid" value="" spellcheck="false">
                            <br>
                            <label for="mchid" class="form-label">微信mchid：</label>
                            <input type="text" class="form-control form-control-radius" id="mchid" value="" spellcheck="false">
                            <br>
                            <label for="mchid" class="form-label">微信mchid：</label>
                            <input type="text" class="form-control form-control-radius" id="mchid" value="" spellcheck="false">
                            <br>
                            <label for="key" class="form-label">微信key：</label>
                            <input type="text" class="form-control form-control-radius" id="key" value="" spellcheck="false">
                            <br>
                            <div class="text-r">
                                <a class="btn-lg btn-rounded btn-default ">保存</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 记录期限参数设置 -->
                <div class="col-md-12 col-lg-6">
                    <div class="panel panel-widget">
                        <div class="panel-title " style="font-size:15px">
                            期限参数
                        </div>
                        <div class="panel-body ">
                            <label for="wsdLog" class="form-label">温湿度记录保存期限(天)：</label>
                            <input type="text" class="form-control form-control-radius" id="wsdLog" value="" spellcheck="false">
                            <br>
                            <label for="warringLog" class="form-label">报警记录保存期限(天)：</label>
                            <input type="text" class="form-control form-control-radius" id="warringLog" value="" spellcheck="false">
                            <br>
                            <label for="opLog" class="form-label">操作记录保存期限(天)：</label>
                            <input type="text" class="form-control form-control-radius" id="opLog" value="" spellcheck="false">
                            <br>
                            <label for="drugLog" class="form-label">药品记录保存期限(天)：</label>
                            <input type="text" class="form-control form-control-radius" id="drugLog" value="" spellcheck="false">
                            <br>
                            <div class="text-r">
                                <a class="btn-lg btn-rounded btn-default ">保存</a>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

            <div class="row">

                <!-- 售药机待机广告设置 -->
                <div class="col-md-12 col-lg-12">
                    <div class="panel panel-widget">
                        <div class="panel-title " style="font-size:15px">
                            售药机广告设置
                        </div>
                        <div class="panel-body ">

                            <div class="col-lg-12 col-md-12 text-r">
                                <a class="btn-lg btn-rounded btn-success">添加</a>
                            </div>

                            <div class="col-lg-6 col-md-12" >
                                <img src="https://i.h2.pdim.gs/dmfd/200_200_100/3e9414e0735045ea0bbd11b3bea21f2b.jpeg" alt="Alternate Text" width="100%" style="border:1px solid"/>                    
                            </div>

                            <div class="col-lg-6 col-md-12" >
                                
                            </div>

                        </div>
                    </div>
                    

                </div>
            </div>


        </div>
        <!-- END CONTAINER -->
    </div>
    <!-- End Content -->
    <!-- //////////////////////////////////////////////////////////////////////////// -->
    <!-- Start Footer -->
    <div class="row footer" style="display:none">
        <div class="col-md-6 text-left">
            Copyright &copy; 2018.Company name All rights reserved.<a href="#">沈阳华天基曼龙有限公司</a>
        </div>
        <div class="col-md-6 text-right">

        </div>
    </div>
    <!-- End Footer -->
    <!-- ================================================
    jQuery Library
    ================================================ -->
    <script type="text/javascript" src="../js/jquery.min.js"></script>

    <!-- ================================================
    Bootstrap Core JavaScript File
    ================================================ -->
    <script src="../js/bootstrap/bootstrap.min.js"></script>

    <!-- ================================================
    Plugin.js - Some Specific JS codes for Plugin Settings
    ================================================ -->
    <script type="text/javascript" src="../js/plugins.js"></script>

    <!-- ================================================
    Data Tables
    ================================================ -->
    <script src="../js/datatables/datatables.min.js"></script>

    <!-- ================================================
    Bootstrap Select
    ================================================ -->
    <script type="text/javascript" src="../js/bootstrap-select/bootstrap-select.js"></script>

    <!-- ================================================
    Bootstrap Toggle
    ================================================ -->
    <script type="text/javascript" src="../js/bootstrap-toggle/bootstrap-toggle.min.js"></script>

    <!-- ================================================
    Moment.js
    ================================================ -->
    <script type="text/javascript" src="../js/moment/moment.min.js"></script>

    <!-- ================================================
    Bootstrap Date Range Picker
    ================================================ -->
    <script type="text/javascript" src="../js/date-range-picker/daterangepicker.js"></script>

    <!-- ================================================
    Sweet Alert
    ================================================ -->
    <script src="../js/sweet-alert/sweet-alert.min.js"></script>

    <!-- ================================================
    Modern Alert
    ================================================ -->
    <script src="../js/Modern-alert/main.js"></script>

    <script>
        var dataTable = null;
        var timeout = null;

        // 设置显示的用户名
        $("#showUser").html(user.realname + "(" + user.username + ")");

        // 添加机组下拉框项
        var machineGroupInfo = commonBind.MachineGroupJsonStr();
        var machineGroupObj = JSON.parse(machineGroupInfo);
        var groupSelect = "<option value='0'>全部</option>";
        for (var gourpItem in machineGroupObj) {
            groupSelect += "<option value='" + machineGroupObj[gourpItem].id + "'>" + machineGroupObj[gourpItem].machine_group_name + "</option>";
        }
        $("#groupSelect").append(groupSelect);
        $("#groupSelect").change(function () {
            var ptitle = $(this).find("option:selected");
            addMachineSelectItem(ptitle.val());
        });


        // 添加机器下拉框项
        function addMachineSelectItem(machineGroupId) {
            $("#machineSelect").empty();
            var machineInfo = commonBind.MachineSelecterJson(machineGroupId);
            var machineObj = JSON.parse(machineInfo);
            var machineSelect = "";
            for (var machineItem in machineObj) {
                machineSelect += "<option value='" + machineObj[machineItem].id + "'>" + machineObj[machineItem].machine_name + "</option>";
            }
            $("#machineSelect").append(machineSelect);
            $("#machineSelect").selectpicker('refresh');
        }
        addMachineSelectItem('0');


        // 搜索机器货道
        function search() {
            var selectMachie = $("#machineSelect").find("option:selected");
            if (selectMachie.length == 0) {
                $("#alerttop").text('请选择机器');
                $("#successtop").fadeOut(1);
                $("#alerttop").fadeIn(350);
                if (timeout != null) {
                    clearTimeout(timeout);
                }
                timeout = setTimeout(function () { $("#alerttop").fadeOut(350); }, 2000);
                return;
            }

            addTableItem($(selectMachie).val());
        }


        // 添加表格项
        function addTableItem(machineId) {
            $("#tableParent").empty();
            $("#tableParent").append("<table id='table' class='table'><thead><tr><th>货道编号</th><th>药品名称</th><th>药品图片</th><th>规格</th><th>生产厂家</th><th>数量</th><th>货道状态</th><th>操作</th></tr></thead></table>");

            var jsonStr = commonBind.MotorJsonStr(machineId);
            var jsonObj = JSON.parse(jsonStr);

            var dataSet = [];
            for (var item in jsonObj) {
                dataSet.push(new Array(jsonObj[item].motor_number, jsonObj[item].drug_name, jsonObj[item].drug_image, jsonObj[item].specification, jsonObj[item].factory, jsonObj[item].stock, jsonObj[item].is_fault, jsonObj[item].id, jsonObj[item].drug_id, jsonObj[item].lot_number_id, jsonObj[item].discount));
            }

            dataTable = $('#table').DataTable({
                "data": dataSet,
                "columns": [
                    { "title": "货道编号" },
                    { "title": "药品名称" },
                    { "title": "药品图片" },
                    { "title": "规格" },
                    { "title": "生产厂家" },
                    { "title": "数量" },
                    { "title": "货道状态" },
                    { "title": "操作" }
                ],
                "pagingType": "full_numbers",
                "createdRow": function (row, data, index) {

                    $(row).attr('data-id', data[7]);
                    $('td', row).eq(8).css('display', 'none');
                    $('td', row).eq(9).css('display', 'none');
                    $('td', row).eq(10).css('display', 'none');
                    $('td', row).eq(7).html('');

                    // 货道没有摆药
                    if (parseInt(data[8]) == 0) {
                        $('td', row).eq(5).html('');
                        //$('td', row).eq(6).html('');
                        //$(row).addClass('info');
                    } else {
                        if (parseInt(data[5]) == 0) {
                            $('td', row).eq(5).addClass('danger');
                        } else if (parseInt(data[5]) < 4) {
                            $('td', row).eq(5).addClass('warning');
                        } else {
                            $('td', row).eq(5).addClass('success');
                        }
                    }

                    if (parseInt(data[6]) == 1) {
                        $('td', row).eq(6).html("故障");
                        $('td', row).eq(6).addClass('danger');
                    } else {
                        $('td', row).eq(6).html("正常");
                        $('td', row).eq(6).addClass('success');
                    }




                    if (data[2] != "") {
                        $('td', row).eq(2).html('');
                        $('td', row).eq(2).html("<img src='" + data[2] + "' width='60%' >");
                    }


                    $('td', row).eq(7).append("<a  class='btn btn-default' data-toggle='modal' data-target='#alterModal' onclick=''>编辑</a>");




                    //var jqRow = $(row);
                    //jqRow.attr('data-id', '' + data[1]);

                    //var td1 = $('td', row).eq(1);
                    //td1.html('');
                },
                "iDisplayLength": 100,
                "bFilter": false,
                "bLengthChange": false,
                "bInfo": false,
                "columnDefs": [{ "orderable": false, "targets": 7 }] // 禁用第8列排序
            });
        }







        /*
          // 修改名称时记录id
        var id = 0;

        // 显示该分组名称
        function showName(obj) {
            id = $(obj).parents('tr').attr('data-id');

            $('#alterGroupName').val($(obj).parents('tr').children(':first-child').text());
        }

        // 修改机器组名称
        function alterGroup(groupName) {
            if (commonBind.AlterMachineGroup(id, groupName)) {
                $("#successtop").text('修改成功');
                $("#alerttop").fadeOut(1);
                $("#successtop").fadeIn(350);
                if (timeout != null) {
                    clearTimeout(timeout);
                }
                timeout = setTimeout(function () { $("#successtop").fadeOut(350); }, 2000);
                $("#alterClose").click();
                addTableItem();
            } else {
                $("#alerttop").text('修改失败');
                $("#successtop").fadeOut(1);
                $("#alerttop").fadeIn(350);
                if (timeout != null) {
                    clearTimeout(timeout);
                }
                timeout = setTimeout(function () { $("#alerttop").fadeOut(350); }, 2000);
            }


        }

        // 添加表格项
        function addTableItem() {


            $("#tableParent").empty();
            $("#tableParent").append("<table id='table' class='table'><thead><tr><th>分组名称</th><th>操作</th></tr></thead></table>");

            var jsonStr = commonBind.MachineGroupJsonStr();
            var jsonObj = JSON.parse(jsonStr);

            var dataSet = [];
            for (var item in jsonObj) {
                dataSet.push(new Array(jsonObj[item].machine_group_name, jsonObj[item].id));
            }

            dataTable = $('#table').DataTable({
                "data": dataSet,
                "columns": [
                    { "title": "分组名称" },
                    { "title": "操作" }
                ],
                "pagingType": "full_numbers",
                "createdRow": function (row, data, index) {
                    var jqRow = $(row);
                    jqRow.attr('data-id', '' + data[1]);

                    var td1 = $('td', row).eq(1);
                    td1.html('');

                    // 删除按钮，修改按钮
                    td1.append("<a  class='btn btn-danger' onclick='deleteGroup(this)'><i class='fa fa-trash-o'></i>删除</a>   <a  class='btn btn-default' data-toggle='modal' data-target='#deleteModal' onclick='showName(this)'><i class='fa fa-gears'></i>修改</a>");
                },
                "iDisplayLength": 50,
                "bFilter": false,
                "bLengthChange": false,
                "bInfo": false,
                "columnDefs": [{ "orderable": false, "targets": 1 }] // 禁用第二列排序
            });
        }


        addTableItem();

        // 删除分组
        function deleteGroup(obj) {
            swal({
                title: "删除分组?",
                text: "确定要删除该分组吗？",
                type: "warning",
                showCancelButton: true,
                confirmButtonColor: "#DD6B55",
                confirmButtonText: "确认",
                cancelButtonText: "取消",
                closeOnConfirm: true,
                closeOnCancel: true
            },
                function (isConfirm) {
                    if (isConfirm) {

                        var id = $(obj).parents('tr').attr('data-id');
                        if (commonBind.RemoveMachineGroup(id)) {
                            $("#successtop").text('删除成功');
                            $("#alerttop").fadeOut(1);
                            $("#successtop").fadeIn(350);
                            if (timeout != null) {
                                clearTimeout(timeout);
                            }
                            timeout = setTimeout(function () { $("#successtop").fadeOut(350); }, 2000);
                            $("#close").click();
                            dataTable.row($(obj).parents('tr')).remove().draw(false);
                        } else {
                            $("#alerttop").text('删除失败');
                            $("#successtop").fadeOut(1);
                            $("#alerttop").fadeIn(350);
                            if (timeout != null) {
                                clearTimeout(timeout);
                            }
                            timeout = setTimeout(function () { $("#alerttop").fadeOut(350); }, 2000);
                        }
                        //swal("Deleted!", "Your imaginary file has been deleted.", "success");
                    } else {
                        //swal("Cancelled", "Your imaginary file is safe :)", "error");
                    }
                });

        }



        // 添加机器分组
        function addGroup(groupName) {
            if (groupName == "") {
                $("#alerttop").text('分组名称不能为空');
                $("#successtop").fadeOut(1);
                $("#alerttop").fadeIn(350);
                if (timeout != null) {
                    clearTimeout(timeout);
                }
                timeout = setTimeout(function () { $("#alerttop").fadeOut(350); }, 2000);
                return;
            }
            var patt = new RegExp(/[!@#\$%\^&\*\(\)\|\?\\\[\]\{=]/);
            if (patt.test(groupName)) {
                $("#alerttop").text('不可以输入特殊字符');
                $("#successtop").fadeOut(1);
                $("#alerttop").fadeIn(350);
                if (timeout != null) {
                    clearTimeout(timeout);
                }
                timeout = setTimeout(function () { $("#alerttop").fadeOut(350); }, 2000);
                return;
            }
            if (commonBind.AddMachineGroup(groupName)) {
                $("#successtop").text('添加成功');
                $("#alerttop").fadeOut(1);
                $("#successtop").fadeIn(350);
                if (timeout != null) {
                    clearTimeout(timeout);
                }
                timeout = setTimeout(function () { $("#successtop").fadeOut(350); }, 2000);
                $("#close").click();
                addTableItem();
            } else {
                $("#alerttop").text('添加失败');
                $("#successtop").fadeOut(1);
                $("#alerttop").fadeIn(350);
                if (timeout != null) {
                    clearTimeout(timeout);
                }
                timeout = setTimeout(function () { $("#alerttop").fadeOut(350); }, 2000);
            }

        }

        */








    </script>




</body>
</html>